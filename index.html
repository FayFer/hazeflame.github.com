<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style type="text/css">
	body{
		background:#D6E9C6 !important;
		color: #fff !important;
	}
	.bg{
		text-align: center;
		position: absolute;
		left: 0;
		top: 0;
		bottom: 0;
		right: 0;
		background:url(bootstrap/img/stock-photo-99282877.jpg) center;
		background-size: cover;
		width: 100%;
	}
	*{
		padding: 0;
		margin: 0 ;
		list-style: none;
	}
	.Entrance{
		position: absolute;
		margin-top: 40px;
	}
	.Entrance input:nth-child(2){
		cursor: pointer;
	}
	#today{
		margin:100px 0;
	}
	#week ul{
		float: left;
	}
</style>
<link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.css"/>
<script src="bootstrap/js/jquery-1.7.2.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
	$(function(){
		var oT=document.querySelector('.Entrance input');
		var oToday=document.getElementById("today");
		var oBtn=document.getElementById("btn");
		var oWeek=document.getElementById("week");
		var oUl=oWeek.children;
			$.ajax({
				type:"get",
				url:"http://v.juhe.cn/weather/index",
				data:{
					key:'4b826f943607fb785f0e749be9a5b86d',
					cityname:'北京'
				},
				async:true,
				dataType:'jsonp',
				success:function(json){
//					console.log(json);
					var str=
						'<li>'+json.result.today.city+'</li>'+
						'<li>'+json.result.today.week+'</li>'+
						'<li>'+json.result.today.date_y+'</li>'+
						'<li>'+json.result.today.temperature+'</li>'+
						'<li>'+json.result.today.dressing_index+'</li>'+
						'<li><span>天气状况:</span>'+json.result.today.weather+'</li>'+
						'<li><span>今日建议:</span>'+json.result.today.dressing_advice+'</li>';
					oToday.innerHTML=str;
					
					var arr=[];
					var future=json.result.future;
//					console.log(future)
					for (var name in future) {
						var str='<li>'+future[name].date+'</li>'+
								'<li>'+future[name].temperature+'</li>'+
								'<li>'+future[name].weather+'</li>'+
								'<li>'+future[name].week+'</li>'+
								'<li>'+future[name].wind+'</li>';
						arr.push(str);
					}
					arr.splice(0,1)
					for (var i=0; i<oUl.length;i++) {
						oUl[i].innerHTML=arr[i];
					}
				},
				error:function(){
					alert('请求天气失败');
				}
			});
		$('.top').on('keyup',function(ev){
			var ev=ev||event;
			if (ev.keyCode==13) {
				getWeather();
			}
		});
		oBtn.onclick=function(){
			getWeather();
		}
		function getWeather(){
			$.ajax({
				type:"get",
				url:"http://v.juhe.cn/weather/index",
				data:{
					key:'4b826f943607fb785f0e749be9a5b86d',
					cityname:oT.value
				},
				async:true,
				dataType:'jsonp',
				success:function(json){
					if (json.resultcode==200) {
							var str=
							'<li>'+json.result.today.city+'</li>'+
							'<li>'+json.result.today.week+'</li>'+
							'<li>'+json.result.today.date_y+'</li>'+
							'<li>'+json.result.today.temperature+'</li>'+
							'<li>'+json.result.today.dressing_index+'</li>'+
							'<li><span>天气状况:</span>'+json.result.today.weather+'</li>'+
							'<li><span>今日建议:</span>'+json.result.today.dressing_advice+'</li>';
						oToday.innerHTML=str;
						
						var arr=[];
						var future=json.result.future;
	//					console.log(future)
						for (var name in future) {
							var str='<li>'+future[name].date+'</li>'+
									'<li>'+future[name].temperature+'</li>'+
									'<li>'+future[name].weather+'</li>'+
									'<li>'+future[name].week+'</li>'+
									'<li>'+future[name].wind+'</li>';
							arr.push(str);
						}
						arr.splice(0,1);
						for (var i=0; i<oUl.length;i++) {
							oUl[i].innerHTML=arr[i];
						}
					}else{
						alert(json.reason+',请重新输入');
						oT.value='';
					}
				},
				error:function(){
					alert('获取天气失败')
				}
			});
		}
	});
</script>
<title></title>
</head>
<body>
	<div class="bg"></div>
	<div style="position: absolute;z-index: 1;">
		<div class="Entrance">
			<input type="text" placeholder="输入城市" class="input-xlarge search-query top"/>
			<input type="button" class="btn disabled " id="btn" value="查询"/>
		</div>
		<ul id="today"></ul>
		<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;未来一周天气</p>
		<div id="week">
			<ul></ul>
			<ul></ul>
			<ul></ul>
			<ul></ul>
			<ul></ul>
			<ul></ul>
		</div>		
	</div>
</body>
</html>
